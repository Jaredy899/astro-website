---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import BlogPostCard from '../../components/BlogPostCard.astro';
import JCLogo from '../../components/JCLogo.astro';

const allPosts = await getCollection('blog');
const posts = allPosts.filter(post => !post.data.draft);

// Collect all unique tags
const tagSet = new Set<string>();
for (const post of posts) {
	if (Array.isArray(post.data.tags)) {
		post.data.tags.forEach(tag => tagSet.add(tag));
	}
}
const allTags = Array.from(tagSet).sort((a, b) => a.localeCompare(b));
---

<Layout title="Blog" description="A collection of blog posts">
	<main class="blog-main">
		<div class="logo-container" transition:name="jc-logo">
			<a href="/" class="logo-link" aria-label="Return to home page">
				<JCLogo />
			</a>
		</div>

		<div class="blog-list">
			{posts.map((post) => (
				<BlogPostCard post={post} />
			))}
		</div>
	</main>
</Layout>

<style>
	.blog-main {
		max-width: 820px;
		margin: 0 auto;
		padding: 2.5rem 1.5rem 4rem 1.5rem;
		position: relative;
	}
	.logo-container {
		width: 40px;
		height: 40px;
		margin: 1rem auto 0.5rem auto;
		transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
		position: absolute;
		top: 0;
		left: 50%;
		transform: translateX(-50%);
		color: var(--text) !important;
	}
	.logo-container :global(svg) {
		color: var(--text) !important;
	}
	.logo-link {
		display: block;
		text-decoration: none;
		transition: transform 0.3s ease;
	}
	.logo-link:hover {
		transform: scale(1.1);
	}

	.blog-list {
		display: flex;
		flex-direction: column;
	}
	@media (max-width: 600px) {
		.blog-main {
			padding: 1rem 0.5rem 2rem 0.5rem;
		}
	}
</style> 